---
title: "Helm + ArgoCD + K3së¥¼ êµ¬ì„±í•´ë³´ì"
description: "ë³µì¡í•¨"
date: 2024-10-29
---

# TL;DR

Helm + ArgoCD + K3Së¥¼ êµ¬ì„±í•´ë´…ë‹ˆë‹¤.  
ì¤‘ê°„ì¤‘ê°„ ì´ë¡ ë„ ê³µë¶€í•˜ê¸° ğŸ¹

## ì´ê²ƒ ë­ì—ìš”??

**Helm**

- ì¿ ë²„ë„¤í‹°ìŠ¤ íŒ¨í‚¤ì§€ ê´€ë¦¬ì
- apt, yum ê³¼ ê°™ì€ ê°œë…
- Chart.yaml : Helm Chartì˜ ë©”íƒ€ë°ì´í„°ì´ë‹¤. Helm name, API ë²„ì „ ë“±ì˜ ê°„ëµí•œ ì†Œê°œ íŒŒì¼ì´ë‹¤.
- values.yaml : Chartì—ì„œ ì‚¬ìš©í•  ì‹¤ì œ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” íŒŒì¼ì´ë‹¤.
  - Helm ChartëŠ” ê¸°ë³¸ì ìœ¼ë¡œ templatesë¥¼ ê¸°ë°˜ìœ¼ë¡œ values.yamlì— ìˆëŠ” ê°’ì„ ì´ìš©í•˜ì—¬ ìƒì„±í•œë‹¤.
  - ê° í™˜ê²½ë§ˆë‹¤ templatesë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šê³  values.yamlë§Œ ìˆ˜ì •í•˜ì—¬ ë‹¤ì–‘í•œ í™˜ê²½ì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤.
- templates : k8sì˜ ë¦¬ì†ŒìŠ¤ í…œí”Œë¦¿ì„ ì €ì¥í•˜ê³  ìˆëŠ” ê³µê°„ì´ë‹¤.
  - Ingress, deployment yaml ë“±ì˜ yaml íŒŒì¼ì„ ë‚´í¬í•˜ê³  ìˆë‹¤.
  - templates í•˜ìœ„ì— ê³µí†µ í¼ì˜ yaml íŒŒì¼ì„ ë§Œë“¤ì–´ ì‚¬ìš©í•œë‹¤.

**ArgoCD**

- GitOpsë¥¼ êµ¬í˜„í•´ì¤Œ
  - ë§Œì•½ì— ì—¬ëŸ¬ëª…ì˜ íŒ€ì›ì´ ìˆë‹¤ê³  í•´ë³´ì, A ì¸í”„ë¼ë¥¼ í”„ë¡œë²„ì €ë‹ í•˜ë ¤ë©´ íŠ¹ì • ëª…ë ¹ì–´ë¥¼ ì‚¬ìš© í•´ì•¼í•˜ëŠ”ë° ì´ê±¸ ì¸ìˆ˜ì¸ê³„ í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´? ë°”ë¡œ ëì¸ê±°ë‹¤
  - ìœ„ì™€ ê°™ì€ ì‚¬íƒœë¥¼ ë§‰ê¸° ìœ„í•´ì„  ì—¬ëŸ¬ê°€ì§€ ì¸í”„ë¼ë¥¼ ì„ ì–¸ì ìœ¼ë¡œ ë§Œë“¤ê³  ì§€ìš¸ ìˆ˜ ìˆëŠ” ì½”ë“œë¡œ êµ¬ì„±ì´ ê°€ëŠ¥í•œ ì„œë¹„ìŠ¤ë“¤ì´ ìˆë‹¤.
  - ArgoCDëŠ” ì½”ë“œ ë³€ê²½ê³¼ ì¸í”„ë¼ ë³€ê²½ì´ Gitì— ì €ì¥ ë˜ê¸° ë•Œë¬¸ì— ë¹ ë¥¸ ì¶”ì ê³¼ ë¡¤ë°±ë“±ì´ ê°€ëŠ¥í•˜ë‹¤.

## ê·¸ë˜ì„œ ì–´ë–»ê²Œ ì”€?

ìš°ì„ , ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ê°€ ìˆì–´ì•¼ í•œë‹¤. í•„ìì˜ ê²½ìš° K3së¥¼ Proxmox ìœ„ì— ì„¤ì¹˜ í•˜ì˜€ë‹¤.

helmì„ ë¨¼ì € ì„¤ì¹˜í•˜ì

```shell
snap install helm
```

ê·¸ í›„, ë…¸ë“œë“¤ê°„ íŒŸë“¤ì˜ êµ¬ì„±ì„ ë„ì™€ì£¼ëŠ” argocdì˜ namespaceë¥¼ ë§Œë“¤ê³ , argocdë¥¼ ì„¤ì¹˜í•´ì¤€ë‹¤.

```shell
sudo k3s kubectl create namespace argocd
helm repo add argo https://argoproj.github.io/argo-helm
helm repo update
helm install argocd argo/argo-cd --namespace argocd
echo 'export KUBECONFIG=/etc/rancher/k3s/k3s.yaml' >> ~/.bashrc
source ~/.bashrc
```

ê·¸ í›„, ì•„ë˜ì˜ ëª…ë ¹ì–´ë¥¼ í†µí•´ í¬íŠ¸ë¥¼ ì—´ê³  ì ‘ì† í•´ì£¼ë©´ ëœë‹¤.

```shell
kubectl port-forward svc/argocd-server -n argocd 8080:443 --address 0.0.0.0
```

ê·¸ë¦¬ê³ , ì•„ë˜ ëª…ë ¹ì–´ë¡œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì•Œì•„ë‚´ê³  admin/(ì•Œì•„ë‚¸ ë¹„ë°€ë²ˆí˜¸)ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¡œê·¸ì¸ í•˜ë©´ ëœë‹¤.

(ì‚¬ì§„ ì²¨ë¶€ ì˜ˆì •)

```
kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath=``"{.data.password}" | base64 -d; echo
```
